(this["webpackJsonphzfe-music"]=this["webpackJsonphzfe-music"]||[]).push([[0],{211:function(e,t,a){e.exports=a(400)},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},219:function(e,t,a){},222:function(e,t,a){},305:function(e,t){},307:function(e,t){},315:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},400:function(e,t,a){"use strict";a.r(t);var n,r,c,i,s,l,u,o,m,f,p,d,b,h,y,g,v,E,j=a(0),O=a.n(j),w=a(31),P=a.n(w),k=a(98),x=a(35),N=a(7),L=a.n(N),M=a(29),I=a(38),C=(a(216),a(48)),S=function(){var e=Object(M.a)(L.a.mark((function e(t){var a,n=arguments;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(n.length>1&&void 0!==n[1])||n[1],t){e.next=3;break}return e.abrupt("return","");case 3:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var n=t.target;e(a?n.result?new Blob([n.result]):null:n.result)},r.onerror=n,a?r.readAsArrayBuffer(t):r.readAsText(t)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){for(var t,a=0,n=e.length,r="";a<n;)t=e.subarray(a,Math.min(a+32768,n)),r+=String.fromCharCode.apply(null,t),a+=32768;return btoa(r)},z=function(e){var t=Math.floor(e/60)||0,a=~~(e-60*t)||0;return(t<10?"0":"")+t+":"+(a<10?"0":"")+a},D=function(e){var t,a=(null===(t=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(e))||void 0===t?void 0:t.map((function(e){return e?Number(e):0})))||[];return 60*a[1]+a[2]+(a[4]?a[4]/(2===(a[4]+"").length?100:1e3):0)},U=function(e){var t=e.split(","),a="";if(t.length){var n=t[0].match(/:(.*?);/);(null===n||void 0===n?void 0:n.length)&&(a=n[1])}for(var r=atob(t[1]),c=r.length,i=new Uint8Array(c);c--;)i[c]=r.charCodeAt(c);return new Blob([i],{type:a})},A=(a(217),function(e){var t=Object(j.useState)([]),a=Object(I.a)(t,2),n=a[0],r=a[1],c=Object(j.useState)(-1),i=Object(I.a)(c,2),s=i[0],l=i[1],u=Object(j.useRef)(null),o=Object(j.useState)(!0),m=Object(I.a)(o,2),f=m[0],p=m[1],d=Object(j.useState)(0),b=Object(I.a)(d,2),h=b[0],y=b[1];Object(j.useEffect)((function(){r(function(e){var t=e;if(t){for(var a=(t=t.replace(/([^\]^\n])\[/g,(function(e,t){return t+"\n["}))).split("\n"),n=[],r=a.length,c=0;c<r;c++){var i=a[c].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),s=a[c].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$/g,"");if(i)for(var l=i.length,u=0;u<l;u++){var o=D(i[u]);n.push({time:o,text:s})}}return(n=n.filter((function(e){return e.text}))).sort((function(e,t){return e.time-t.time})),n}return[]}(e.lrc))}),[e.lrc]),Object(j.useEffect)((function(){l(function(e,t){if(e.length<=0)return-1;for(var a=0;a<e.length&&!(e[a].time>t);)a++;return a-1}(n,e.currentTime)),n.length&&n[s]&&e.setCurrentLrc(n[s].text)}),[s,n,e,e.currentTime]),Object(j.useEffect)((function(){if(u&&f&&e.isPlaying){var t=u.current,a=h*(s-1)||0;t&&t.scrollTo({top:a,behavior:"smooth"})}}),[f,h,s,e.isPlaying]);var g=function(e){return s===e?"choose-lrc":""},v=function(){y(7.5*document.body.offsetHeight/100)};return Object(j.useEffect)((function(){return window.addEventListener("resize",v),v(),function(){window.removeEventListener("resize",v)}}),[]),O.a.createElement("section",{className:"music-lrc",ref:u,onMouseEnter:function(){p(!1)},onMouseLeave:function(){if(e.isPlaying){var t=u.current,a=h*(s-1)||0;t&&t.scrollTo({top:a,behavior:"auto"}),p(!0)}else p(!0)}},O.a.createElement("section",{className:"lrc-list"},n.map((function(t,a){return O.a.createElement("p",{key:"".concat(t.time).concat(s).concat(t.text),style:{color:s===a?e.color:""},className:g(a)},t.text)}))))}),R=(a(218),a(219),a(405)),H=function(e){var t=Object(j.useState)(0),a=Object(I.a)(t,2),n=a[0],r=a[1],c=Object(j.useState)(!1),i=Object(I.a)(c,2),s=i[0],l=i[1];Object(j.useEffect)((function(){s||r(e.range)}),[s,e.range]);return O.a.createElement("section",{className:"progress"},O.a.createElement(R.a,{defaultValue:0,value:n,onChange:function(t){l(!0),e.setChange(!0),r(t),e.handleChanging(t)},onAfterChange:function(t){e.setChange(!1),l(!1)},tooltipVisible:!1}))},K=a(408),F=a(409),B=a(410),q=a(411),J=a(161),V=a(42),Z=a(131),$=a(132),G=a(34),Q=(a(221),a(17)),W=a(196),X=a(41),Y=a.n(X),_=function(){var e=Object(M.a)(L.a.mark((function e(t){var a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-lrc-list",e.next=3,Y.a.getItem("music-lrc-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return a=e.t0,a.every((function(e){return e.fileName!==t.fileName}))&&a.push(t),e.abrupt("return",Y.a.setItem("music-lrc-list",a));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-lrc-list",e.next=3,Y.a.getItem("music-lrc-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return t=e.t0,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(M.a)(L.a.mark((function e(t,a){var n,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-list",e.next=3,Y.a.getItem("music-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:if(n=e.t0,!n.every((function(e){return e.fileName!==t.fileName}))){e.next=14;break}return r="".concat(t.fileName,"-").concat(100*Math.random(),"-").concat(Date.now()),t.id=r,e.next=13,Y.a.setItem(r,a);case 13:n.push(t);case 14:return e.abrupt("return",Y.a.setItem("music-list",n));case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ae=function(){var e=Object(M.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(M.a)(L.a.mark((function e(a,n){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"music-list",e.next=4,Y.a.getItem("music-list");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:return r=(r=e.t0).filter((function(e){return e.id!==t})),e.next=11,Y.a.setItem("music-list",r);case 11:return e.next=13,Y.a.removeItem(t);case 13:a(!0),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(0),n(e.t1);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-list",e.next=3,Y.a.getItem("music-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return t=e.t0,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(M.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(M.a)(L.a.mark((function e(a,n){var r,c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.a.getItem("music-list");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:if(r=e.t0,c=r.filter((function(e){return e.id===t}))[0]){e.next=11;break}n("\u83b7\u53d6\u6b4c\u66f2\u4fe1\u606f\u5931\u8d25"),e.next=21;break;case 11:return e.next=13,Y.a.getItem(t);case 13:if(c.music=e.sent,!c.lrcKey){e.next=19;break}return e.next=17,ee();case 17:e.sent.forEach((function(e){e.fileName===c.lrcKey&&(c.lrc=e.content)}));case 19:c.picture.length>0&&(c.pictureUrl=URL.createObjectURL(U(c.picture[0]))),a(c);case 21:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(M.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(M.a)(L.a.mark((function e(a,n){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"music-lrc-list",e.next=4,Y.a.getItem("music-lrc-list");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:return r=(r=e.t0).filter((function(e){return e.fileName!==t})),e.next=11,Y.a.setItem("music-lrc-list",r);case 11:a(!0),e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),n(e.t1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=a(209),se=new(n=function(){function e(){var t=this;Object(Z.a)(this,e),Object(V.a)(this,"preUrl",r,this),Object(V.a)(this,"preImgUrl",c,this),Object(V.a)(this,"musicPlayer",i,this),this.handlePlay=function(){var e,a,n;(console.log("\u6b4c\u66f2\u64ad\u653e\u4e86"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),duration:null===(a=t.musicPlayer)||void 0===a?void 0:a.duration(),playing:!0,change:!1}),t.musicInfo&&!t.musicInfo.duration)&&(t.musicInfo.duration=Number(null===(n=t.musicPlayer)||void 0===n?void 0:n.duration()));var r=window.navigator,c=window.MediaMetadata;r.mediaSession&&t.musicInfo&&(r.mediaSession.metadata=new c({title:t.musicInfo.name,artist:t.musicInfo.artist,album:t.musicInfo.album,artwork:[{src:t.musicInfo.pictureUrl||"",type:"image/jpeg",sizes:"512x512"}]}))},this.handlePause=function(){var e;console.log("\u6b4c\u66f2\u6682\u505c\u4e86"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1})},this.handleEnd=function(){var e;t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1}),requestAnimationFrame(t.handlePlaying),console.log("\u6b4c\u66f2\u64ad\u653e\u5b8c\u4e86"),t.handleNextMusic()},this.handleStop=function(){var e;console.log("\u6b4c\u66f2\u505c\u6b62"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1})},this.handlePlaying=function(){if(!t.musicData.change&&t.musicPlayer&&t.musicPlayer.playing()){t.updatedMusicData({type:"update",currentTime:t.musicPlayer.seek()});var e=window.navigator;e.mediaSession&&t.musicPlayer&&e.mediaSession.setPositionState({duration:Number(t.musicPlayer.duration()),playbackRate:1,position:t.musicPlayer.seek()}),requestAnimationFrame(t.handlePlaying)}},Object(V.a)(this,"musicInfo",s,this),Object(V.a)(this,"musicData",l,this),Object(V.a)(this,"musicPlayerStats",u,this),Object(V.a)(this,"musicPlayList",o,this),Object(V.a)(this,"updateMusicPlayList",m,this),this.handleNextMusic=function(){t.musicPlayer&&t.musicPlayer.stop();for(var e=0,a=t.musicPlayList.length-1;e<t.musicPlayList.length&&t.musicPlayList[e].id!==t.musicData.id;)e++;var n,r=e+1;(r=r>a?r-a-1:r,t.musicPlayList[r].id===t.musicData.id)?null===(n=t.musicPlayer)||void 0===n||n.play():se.updatedMusicData({id:t.musicPlayList[r].id})},this.handlePreMusic=function(){t.musicPlayer&&t.musicPlayer.stop();for(var e=0,a=t.musicPlayList.length-1;e<t.musicPlayList.length&&t.musicPlayList[e].id!==t.musicData.id;)e++;var n,r=e-1;(r=r<0?a:r,t.musicPlayList[r].id===t.musicData.id)?null===(n=t.musicPlayer)||void 0===n||n.play():se.updatedMusicData({id:t.musicPlayList[r].id})},Object(V.a)(this,"localMusicList",f,this),Object(V.a)(this,"localMusicLoading",p,this),Object(V.a)(this,"updateLocalMusicList",d,this),Object(V.a)(this,"deleteMusic",b,this),this.localMusicLrcList=[],Object(V.a)(this,"localMusicLrcLoading",h,this),Object(V.a)(this,"updateLocalMusicLrcList",y,this),Object(V.a)(this,"deleteLrc",g,this),Object(V.a)(this,"musicColor",v,this),Object(V.a)(this,"updateMusicColor",E,this)}return Object($.a)(e,[{key:"updatePreUrl",value:function(e){this.preUrl=e}},{key:"updatePreImgUrl",value:function(e){this.preImgUrl.push(e),this.preImgUrl.length>=5&&URL.revokeObjectURL(this.preImgUrl.shift())}},{key:"createdPlayer",value:function(){var e,t=this;if(this.musicInfo){this.updatedMusicData({playing:!1});var a=URL.createObjectURL(this.musicInfo.music);this.preUrl&&URL.revokeObjectURL(this.preUrl),this.updatePreUrl(a),this.updatePreImgUrl(this.musicInfo.pictureUrl||""),this.musicPlayer=new W.Howl({autoplay:!0,src:a,html5:!0,format:[(e=this.musicInfo.codec.toLowerCase()||String(this.musicInfo.fileType).toLowerCase(),"mpeg 1 layer 3"===e?"mp3":e)],volume:1,onplay:this.handlePlay,onpause:this.handlePause,onend:this.handleEnd,onstop:this.handleStop});var n=window.navigator;n.mediaSession&&(n.mediaSession.setActionHandler("play",(function(){var e;null===(e=t.musicPlayer)||void 0===e||e.play()})),n.mediaSession.setActionHandler("pause",(function(){var e;null===(e=t.musicPlayer)||void 0===e||e.pause()})),n.mediaSession.setActionHandler("stop",(function(){var e;null===(e=t.musicPlayer)||void 0===e||e.stop()})),n.mediaSession.setActionHandler("seekto",(function(e){console.log(1,e)})),n.mediaSession.setActionHandler("seekbackward",(function(e){var a,n;t.updatedMusicData({change:!0});var r=Number(null===(a=t.musicPlayer)||void 0===a?void 0:a.seek())-10;null===(n=t.musicPlayer)||void 0===n||n.seek(r),t.updatedMusicData({change:!1}),console.log("\u5feb\u9000")})),n.mediaSession.setActionHandler("seekforward",(function(e){var a,n;t.updatedMusicData({change:!0});var r=Number(null===(a=t.musicPlayer)||void 0===a?void 0:a.seek())+10;null===(n=t.musicPlayer)||void 0===n||n.seek(r),t.updatedMusicData({change:!1}),console.log("\u5feb\u8fdb")})),n.mediaSession.setActionHandler("previoustrack",this.handlePreMusic),n.mediaSession.setActionHandler("nexttrack",this.handleNextMusic))}}},{key:"destroyPlayer",value:function(){this.musicPlayer=null}},{key:"updatedMusicInfo",value:function(e){0===e.picture.length&&(e.picture=["".concat(".","/images/music-no.jpeg")]),this.musicInfo=e}},{key:"updatedMusicData",value:function(e){var t=this;"update"!==e.type?(e.hasOwnProperty("min")&&(e.min?document.body.classList.remove("dialog-screen"):document.body.classList.add("dialog-screen")),e.change||setTimeout((function(){requestAnimationFrame(t.handlePlaying)}),100),this.musicData=Object(J.a)(Object(J.a)({},this.musicData),e)):this.musicData.currentTime=e.currentTime}}]),e}(),r=Object(G.a)(n.prototype,"preUrl",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(G.a)(n.prototype,"updatePreUrl",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"updatePreUrl"),n.prototype),c=Object(G.a)(n.prototype,"preImgUrl",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(G.a)(n.prototype,"updatePreImgUrl",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"updatePreImgUrl"),n.prototype),i=Object(G.a)(n.prototype,"musicPlayer",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(G.a)(n.prototype,"createdPlayer",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"createdPlayer"),n.prototype),Object(G.a)(n.prototype,"destroyPlayer",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"destroyPlayer"),n.prototype),s=Object(G.a)(n.prototype,"musicInfo",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(G.a)(n.prototype,"updatedMusicInfo",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"updatedMusicInfo"),n.prototype),l=Object(G.a)(n.prototype,"musicData",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{id:"",playing:!1,duration:0,currentTime:0,change:!1,min:!0}}}),Object(G.a)(n.prototype,"updatedMusicData",[Q.f],Object.getOwnPropertyDescriptor(n.prototype,"updatedMusicData"),n.prototype),u=Object(G.a)(n.prototype,"musicPlayerStats",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{loop:"random"}}}),o=Object(G.a)(n.prototype,"musicPlayList",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=Object(G.a)(n.prototype,"updateMusicPlayList",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.musicPlayList=t}}}),f=Object(G.a)(n.prototype,"localMusicList",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=Object(G.a)(n.prototype,"localMusicLoading",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=Object(G.a)(n.prototype,"updateLocalMusicList",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localMusicLoading=!0,t.next=3,ne();case 3:e.localMusicList=t.sent,e.updateMusicPlayList(Object(C.cloneDeep)(e.localMusicList)),e.localMusicLoading=!1;case 6:case"end":return t.stop()}}),t)})))}}),b=Object(G.a)(n.prototype,"deleteMusic",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(M.a)(L.a.mark((function t(a){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ae(a);case 3:ie.b.success("\u5220\u9664\u6210\u529f"),e.updateLocalMusicList(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),ie.b.error("\u5220\u9664\u5931\u8d25");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}}),h=Object(G.a)(n.prototype,"localMusicLrcLoading",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=Object(G.a)(n.prototype,"updateLocalMusicLrcList",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object(M.a)(L.a.mark((function t(){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localMusicLrcLoading=!0,t.next=3,ee();case 3:e.localMusicLrcList=t.sent,e.localMusicLrcLoading=!1;case 5:case"end":return t.stop()}}),t)})))}}),g=Object(G.a)(n.prototype,"deleteLrc",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(M.a)(L.a.mark((function t(a){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ce(a);case 3:ie.b.success("\u5220\u9664\u6210\u529f"),e.updateLocalMusicLrcList(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),ie.b.error("\u5220\u9664\u5931\u8d25");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}}),v=Object(G.a)(n.prototype,"musicColor",[Q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"#1890ff"}}),E=Object(G.a)(n.prototype,"updateMusicColor",[Q.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.musicColor=t,document.documentElement.style.setProperty("--primary-color",t)}}}),n),le=se,ue=function(e){var t,a,n=Object(j.useState)(0),r=Object(I.a)(n,2),c=r[0],i=r[1];return Object(j.useEffect)((function(){var t,a=(null===(t=e.currentInfo)||void 0===t?void 0:t.duration)||e.musicPlayingInfo.duration||0;i(e.currentTime/a*100)}),[e.currentInfo,e.currentTime,e.musicPlayingInfo.duration]),O.a.createElement("section",{className:"player-control"},e.min?O.a.createElement("section",{className:"control-min"},O.a.createElement("section",{className:"control-icon-list"},O.a.createElement("p",{onClick:le.handlePreMusic},O.a.createElement(K.a,null)),O.a.createElement("p",{className:"icon-play-bg",onClick:function(){e.isPlaying?e.handlePause():e.handlePlay()}},e.isPlaying?O.a.createElement(F.a,null):O.a.createElement(B.a,null)),O.a.createElement("p",{onClick:le.handleNextMusic},O.a.createElement(q.a,null))),O.a.createElement("section",{className:"control-progress"},O.a.createElement(H,{range:Number(c.toFixed(2)),handleChanging:e.handleChanging,setChange:e.setChange})),O.a.createElement("section",{className:"line-left"},O.a.createElement("span",null," ",z(e.currentTime||0)," "),O.a.createElement("span",null,"/"),O.a.createElement("span",null," ",z((null===(t=e.currentInfo)||void 0===t?void 0:t.duration)||e.musicPlayingInfo.duration||0)," "))):O.a.createElement("section",{className:"control"},O.a.createElement("section",{className:"control-progress"},O.a.createElement(H,{range:Number(c.toFixed(2)),handleChanging:e.handleChanging,setChange:e.setChange})),O.a.createElement("section",{className:"control-line"},O.a.createElement("section",{className:"line-left"},O.a.createElement("span",null," ",z(e.currentTime||0)," "),O.a.createElement("span",null," ",z((null===(a=e.currentInfo)||void 0===a?void 0:a.duration)||e.musicPlayingInfo.duration||0)," ")),O.a.createElement("section",{className:"line-center"},O.a.createElement("section",{className:"control-icon-list"},O.a.createElement("p",{onClick:le.handlePreMusic},O.a.createElement(K.a,null)),O.a.createElement("p",{className:"icon-play-bg",onClick:function(){e.isPlaying?e.handlePause():e.handlePlay()}},e.isPlaying?O.a.createElement(F.a,null):O.a.createElement(B.a,null)),O.a.createElement("p",{onClick:le.handleNextMusic},O.a.createElement(q.a,null)))))))},oe=(a(222),function(e){var t=Object(j.useState)([]),a=Object(I.a)(t,2),n=a[0],r=a[1],c=Object(j.useState)(-1),i=Object(I.a)(c,2),s=i[0],l=i[1],u=Object(j.useRef)(null),o=Object(j.useState)(!0),m=Object(I.a)(o,2),f=m[0],p=m[1],d=Object(j.useState)({backgroundImage:""}),b=Object(I.a)(d,2),h=b[0],y=b[1],g=Object(j.useState)(0),v=Object(I.a)(g,2),E=v[0],w=v[1];Object(j.useEffect)((function(){r(function(e){var t=[];console.log("\u8fdb\u5165\u9010\u5b57\u89e3\u6790\u7684\u6b4c\u8bcd\u54e6");for(var a=e.split("\n"),n=0;n<a.length;){var r=a[n].replace(/\s/g,""),c=r.match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),i=r.match(/(?<=\])\S\s?(?=\[)/g);if(c&&i){for(var s=[],l=0;l<i.length;l++)s.push({text:i[l],start:D(c[l]),end:D(c[l+1])});t.push(s)}n++}return t}(e.lrc))}),[e.lrc]),Object(j.useEffect)((function(){if(l(function(e,t){if(e.length<=0)return-1;for(var a=0;a<e.length&&!(e[a][0].start>t);)a++;return a-1}(n,e.currentTime)),n[s]&&n[s].length){var t=n[s].map((function(e){return e.text}));e.setCurrentLrc(t.join(""))}var a=function(e,t){if(!e)return 0;for(var a=0,n=0;n<e.length&&!(e[n].start>t);)n++;if(n<=0)return 0;if(n>=e.length)return 100;a=n*(100/e.length);var r=e[n-1];if(t>=r.end)return 100;if(t<=r.start)return(n-1)*(100/e.length);var c=r.end-r.start;return a+=(t-r.start)/c*(100/e.length)}(n[s],e.currentTime);y({backgroundImage:"-webkit-linear-gradient(left,".concat(e.color," ").concat(a,"%,#ffffff ").concat(a,"%)")})}),[s,n,e,e.currentTime]),Object(j.useEffect)((function(){if(u&&f&&e.isPlaying){var t=u.current,a=E*(s-1)||0;t&&t.scrollTo({top:a,behavior:"smooth"})}}),[f,E,s,e.isPlaying]);var P=function(e){return s===e?"choose-lrc-line":""},k=function(){w(7.5*document.body.offsetHeight/100)};return Object(j.useEffect)((function(){return window.addEventListener("resize",k),k(),function(){window.removeEventListener("resize",k)}}),[]),O.a.createElement("section",{className:"music-lrc-word",ref:u,onMouseEnter:function(){p(!1)},onMouseLeave:function(){if(p(!0),e.isPlaying){var t=u.current,a=E*(s-1)||0;t&&t.scrollTo({top:a,behavior:"auto"})}}},O.a.createElement("section",{className:"lrc-list"},n.map((function(e,t){return O.a.createElement("section",{key:t,className:"lrc-line"},O.a.createElement("p",{className:P(t),style:s===t?h:{}},e.map((function(e,t){return O.a.createElement("span",{key:t},e.text)}))))}))))}),me=a(198),fe=a(160),pe=a(141),de=a(99),be=new me.a,he=Object(de.a)((function(){var e,t=le.musicPlayer,a=le.musicInfo,n=le.musicData,r=Object(j.useState)(""),c=Object(I.a)(r,2),i=c[0],s=c[1],l=Object(j.useRef)(!1),u=le.musicColor,o=function(e){var t=((null===a||void 0===a?void 0:a.duration)||0)*e/100;le.updatedMusicData({currentTime:t})},m=function(e){e||(null===t||void 0===t||t.seek(n.currentTime),n.playing||null===t||void 0===t||t.play()),le.updatedMusicData({change:e})},f=Object(j.useCallback)(Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(M.a)(L.a.mark((function e(t,a){var r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(n.id);case 2:(r=e.sent)?t(r):a("\u6b4c\u66f2\u4fe1\u606f\u83b7\u53d6\u5931\u8d25");case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),[n.id]),p=Object(j.useCallback)((function(){t&&(t.playing()?t.pause():t.play())}),[t]),d=Object(j.useCallback)(Object(M.a)(L.a.mark((function e(){var t;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,f();case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return");case 7:le.updatedMusicInfo(t),be.getColorAsync(t.pictureUrl||"").then((function(e){le.updateMusicColor(Object(fe.b)(.8,Object(fe.a)(.5,e.rgba)))})).catch((function(e){le.updateMusicColor("#1890ff")}));case 9:case"end":return e.stop()}}),e)}))),[f,n.id]),b=Object(j.useCallback)((function(e){e.preventDefault(),32===e.keyCode&&p()}),[p]),h=function(){le.updatedMusicData({min:!n.min})};return Object(j.useEffect)((function(){console.log("useEffect-getMusicInfo"),d()}),[d]),Object(j.useEffect)((function(){return console.log("useEffect-create"),a&&!t&&(s(""),console.log("\u521b\u5efa\u97f3\u4e50\u5b9e\u4f8b"),le.createdPlayer()),function(){t&&(console.log("created destroy"),le.updatedMusicData({playing:!1}),le.destroyPlayer())}}),[a,t]),Object(j.useEffect)((function(){console.log("music-change-key"),l.current=n.change}),[n.change]),Object(j.useEffect)((function(){return window.addEventListener("keydown",b),function(){window.removeEventListener("keydown",b)}}),[b]),O.a.createElement("section",{className:"player"},n.min?O.a.createElement("section",{className:"player-min"},a?O.a.createElement("section",{className:"player-layout"},O.a.createElement("section",{className:"layout-left"},O.a.createElement("section",{className:"music-img",onClick:h},O.a.createElement("img",{src:a.pictureUrl?a.pictureUrl:"./images/music-no.jpeg",alt:""})),O.a.createElement("section",{className:"player-info"},O.a.createElement("p",{className:"music-name"},a.name),O.a.createElement("p",{className:"music-artist"},a.artist," - ",a.album))),O.a.createElement("section",{className:"music-progress"},O.a.createElement(ue,{handlePlay:p,handlePause:p,currentInfo:a||null,musicPlayingInfo:n,currentTime:n.currentTime,handleChanging:o,setChange:m,min:n.min,isPlaying:n.playing}))):O.a.createElement("section",{className:"player-layout"},"\u8bf7\u9009\u62e9\u6b4c\u66f2\u8fdb\u884c\u64ad\u653e")):O.a.createElement("section",{className:"player-max"},O.a.createElement("section",{className:"status-control",onClick:h},O.a.createElement(pe.a,null)),O.a.createElement("section",{className:"player-bg",style:{backgroundImage:"url(".concat((null===a||void 0===a?void 0:a.pictureUrl)||"./images/music-no.jpeg",")")}}),O.a.createElement("section",{className:"player-fade"}),O.a.createElement("section",{className:"player-layout"},a?O.a.createElement("section",{className:"player-box"},O.a.createElement("section",{className:"player-left"},O.a.createElement("section",{className:"player-line"},O.a.createElement("img",{src:a.pictureUrl?a.pictureUrl:"./images/music-no.jpeg",alt:""})),O.a.createElement("section",{className:"player-line"},O.a.createElement("section",{className:"player-info"},O.a.createElement("p",{className:"music-name"},a.name),O.a.createElement("p",{className:"music-artist"},a.artist," - ",a.album),O.a.createElement("p",{className:"music-current-lrc"},i))),O.a.createElement(ue,{handlePlay:p,handlePause:p,currentInfo:a||null,musicPlayingInfo:n,currentTime:n.currentTime,handleChanging:o,setChange:m,isPlaying:n.playing})),O.a.createElement("section",{className:"player-right"},(null===(e=a.lrc)||void 0===e?void 0:e.match(/\](\S)\[/g))?O.a.createElement(oe,{setCurrentLrc:s,color:u,lrc:a.lrc||"",currentInfo:a||null,currentTime:n.currentTime,isPlaying:n.playing}):O.a.createElement(A,{setCurrentLrc:s,color:u,lrc:a.lrc||"",currentInfo:a||null,currentTime:n.currentTime,isPlaying:n.playing}))):"")))})),ye=a(199),ge=a(403),ve=a(52),Ee=a(412),je=(a(315),["mp3","ogg","wav","aac","flac","dolby","opus","webm","alac"]),Oe=["lrc","txt"],we=a(156),Pe=a.n(we),ke=function(){var e=function(){var e=Object(M.a)(L.a.mark((function e(t){var a,n,r,c,i,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name.split("."),n=a[a.length-1],r=t.name.replace(".".concat(n),""),e.prev=3,e.next=6,S(t,!0);case 6:return c=e.sent,e.next=9,ye.parseBlob(c);case 9:i=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(3),ie.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(n,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(r)),e.abrupt("return");case 16:l=i,(s={name:Object(C.get)(l,"common.title",""),album:Object(C.get)(l,"common.album",""),albumartist:Object(C.get)(l,"common.albumartist",""),artist:Object(C.get)(l,"common.artist",""),artists:Object(C.get)(l,"common.artists",[]),comment:Object(C.get)(l,"common.comment",[]),date:Object(C.get)(l,"common.date",0),picture:Object(C.get)(l,"common.picture",[]).map((function(e){return"data:".concat(e.format,";base64,").concat(T(e.data))})),codec:Object(C.get)(l,"format.codec",""),duration:Object(C.get)(l,"format.duration",0),sampleRate:Object(C.get)(l,"format.sampleRate",""),lrc:""}).fileName=r,s.fileType=n,s.fileSize=Pe()(t.size),s.size=t.size,s.name=s.name||s.fileName||"\u672a\u77e5\u6b4c\u66f2",te(s,c).then((function(e){console.log(e),ie.b.success("".concat(t.name,"  \u4e0a\u4f20\u6210\u529f")),le.updateLocalMusicList()}));case 23:case"end":return e.stop()}var l}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(M.a)(L.a.mark((function e(t){var a,n,r,c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name.split("."),n=a[a.length-1],r=t.name.replace(".".concat(n),""),c="",e.prev=4,e.next=7,S(t,!1);case 7:c=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),ie.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(n,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(r)),e.abrupt("return");case 14:_({content:c,fileName:r,fileType:n,size:t.size,fileSize:Pe()(t.size)}).then((function(e){le.updateLocalMusicLrcList(),ie.b.success("".concat(t.name,"  \u4e0a\u4f20\u6210\u529f"))}));case 15:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}();return O.a.createElement("section",{className:"page-upload"},O.a.createElement("section",{className:"upload-line"},O.a.createElement(ge.a,{beforeUpload:function(a){var n=a.name.split("."),r=n[n.length-1],c=a.name.replace(".".concat(r),"");return je.includes(r)?(console.log("\u5f53\u524d\u662f\u97f3\u9891\u6587\u4ef6\u5904\u7406",c,r),e(a),!1):Oe.includes(r)?(console.log("\u5f53\u524d\u662f\u6b4c\u8bcd\u6587\u4ef6\u5904\u7406",c,r),t(a),!1):(ie.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(r,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(c)),!1)},showUploadList:!1,accept:function(){var e=je.concat(Oe);return(e=e.map((function(e){return e=".".concat(e)}))).join(",")}(),multiple:!0},O.a.createElement(ve.a,{icon:O.a.createElement(Ee.a,null)},"\u70b9\u51fb\u4e0a\u4f20\u672c\u5730\u6b4c\u66f2\u6216\u8005\u6b4c\u8bcd")),O.a.createElement("p",{className:"tips"},O.a.createElement("span",null,"\u652f\u6301\u6b4c\u66f2\u683c\u5f0f ",je.join("\uff0c")),O.a.createElement("span",null,"\u652f\u6301\u6b4c\u8bcd\u683c\u5f0f ",Oe.join("\uff0c")))))},xe=a(404),Ne=a(406),Le=a(402),Me=Object(de.a)((function(){var e=[{title:"\u6b4c\u8bcd\u540d",dataIndex:"fileName",key:"fileName"},{title:"\u5927\u5c0f",dataIndex:"fileSize",key:"fileSize",sorter:function(e,t){return e.size-t.size}},{title:"\u64cd\u4f5c",dataIndex:"name",key:"control",render:function(e,t){return O.a.createElement("p",null,O.a.createElement(Ne.a,{placement:"topRight",title:"\u786e\u5b9a\u5220\u9664-".concat(t.fileName,"-\u6b4c\u8bcd\u561b"),onConfirm:function(){return n(t.fileName||"")},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},O.a.createElement("span",{className:"link"},"\u5220\u9664")))}}],t=le.localMusicLrcList,a=le.localMusicLrcLoading,n=function(e){le.deleteLrc(e)};return Object(j.useEffect)((function(){console.log("\u83b7\u53d6\u6b4c\u8bcd\u5217\u8868"),le.updateLocalMusicLrcList()}),[]),O.a.createElement("section",{className:"lrc-list"},O.a.createElement(Le.a,{dataSource:t,columns:e,pagination:!1,rowKey:"fileName",loading:a}))})),Ie=a(407),Ce=(a(386),a(387),function(){return O.a.createElement("p",{className:"playing-icon"},O.a.createElement("span",{className:"rect1"}),O.a.createElement("span",{className:"rect2"}),O.a.createElement("span",{className:"rect3"}),O.a.createElement("span",{className:"rect4"}),O.a.createElement("span",{className:"rect5"}))}),Se=Object(de.a)((function(){var e=le.musicData,t=le.localMusicList,a=le.localMusicLoading,n=[{title:"\u6b4c\u66f2",dataIndex:"name",key:"name",width:300,render:function(t,a){return O.a.createElement("section",{className:"list-play"},(null===e||void 0===e?void 0:e.id)===a.id&&e.playing?O.a.createElement("span",null,O.a.createElement(F.a,{className:"icon",onClick:function(){return c()}})):O.a.createElement("span",null,O.a.createElement(B.a,{className:"icon",onClick:function(){return r(a)}})),O.a.createElement("span",null,t),(null===e||void 0===e?void 0:e.id)===a.id&&e.playing?O.a.createElement(Ce,null):"")}},{title:"\u6b4c\u624b",dataIndex:"artist",key:"artist"},{title:"\u4e13\u8f91",dataIndex:"album",key:"album"},{title:"\u65f6\u957f",dataIndex:"duration",key:"duration",render:function(e){return z(e)||"\u672a\u77e5"},sorter:function(e,t){return Number(e.duration)-Number(t.duration)}},{title:"\u683c\u5f0f",dataIndex:"codec",key:"codec",render:function(e,t){return e||t.fileType}},{title:"\u5927\u5c0f",dataIndex:"fileSize",key:"fileSize",sorter:function(e,t){return Number(e.size)-Number(t.size)}},{title:"\u5173\u8054\u6b4c\u8bcd\u540d",dataIndex:"lrcKey",key:"lrcKey",render:function(e,t){return e||O.a.createElement(Ie.b,{size:"middle"},O.a.createElement("span",{className:"action"},"\u5173\u8054\u6b4c\u8bcd"))}},{title:"\u64cd\u4f5c",dataIndex:"name",key:"control",render:function(e,t){return O.a.createElement("p",null,O.a.createElement(Ne.a,{placement:"topRight",title:"\u786e\u5b9a\u5220\u9664-".concat(t.name,"-\u8fd9\u9996\u6b4c\u561b"),onConfirm:function(){return i(t.id||"")},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},O.a.createElement("span",{className:"link"},"\u5220\u9664")))}}],r=function(t){var a;t.id!==e.id?(null===(a=le.musicPlayer)||void 0===a||a.stop(),setTimeout((function(){le.updatedMusicData({id:t.id})}),100)):le.musicPlayer&&le.musicPlayer.play()},c=function(){var e;null===(e=le.musicPlayer)||void 0===e||e.pause()},i=function(e){le.deleteMusic(e)};return Object(j.useEffect)((function(){console.log("\u83b7\u53d6\u97f3\u4e50\u5217\u8868"),le.updateLocalMusicList()}),[]),O.a.createElement("section",{className:"lrc-list"},O.a.createElement(Le.a,{dataSource:t,columns:n,pagination:!1,rowKey:"fileName",loading:a}))})),Te=xe.a.TabPane,ze=function(){var e=Object(x.f)(),t=new URLSearchParams(Object(x.g)().search),a=Object(x.g)(),n=Object(j.useState)(""),r=Object(I.a)(n,2),c=r[0],i=r[1],s=function(){var e=Object(M.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(M.a)(L.a.mark((function e(t,a){var n,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ne();case 3:return n=e.sent,e.next=6,ee();case 6:return r=e.sent,n=n.map((function(e){return r.forEach((function(t){t.fileName.includes(e.name)&&(e.lrcKey=t.fileName)})),e})),e.next=10,Y.a.setItem("music-list",n);case 10:t("success"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),a(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,a){return e.apply(this,arguments)}}());case 2:ie.b.success("\u5173\u8054\u6210\u529f"),le.updateLocalMusicList(),le.updateLocalMusicLrcList();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.useEffect)((function(){if(t){var e=t.get("type")||"";["music","lrc"].includes(e)?i(e):i("music")}}),[t]),O.a.createElement("section",{className:"page-local"},O.a.createElement("section",{className:"local-upload"},O.a.createElement(ke,null),O.a.createElement("section",null,O.a.createElement(ve.a,{onClick:s},"\u81ea\u52a8\u5173\u8054\u6b4c\u8bcd"),O.a.createElement("p",{className:"tips"},"\u5173\u8054\u89c4\u5219: \u5f53\u524d\u6b4c\u66f2\u6ca1\u6709\u6b4c\u8bcd\uff0c\u540c\u65f6\u53ef\u4ee5\u627e\u5230\u6b4c\u8bcd\u540d\uff0c\u5305\u542b\u5b8c\u6574\u6b4c\u66f2\u540d"))),O.a.createElement("section",{className:"local-content"},O.a.createElement(xe.a,{activeKey:c,onChange:function(t){e.push("".concat(a.pathname,"?type=").concat(t))}},O.a.createElement(Te,{tab:"\u97f3\u4e50\u5217\u8868",key:"music"},O.a.createElement(Se,null)),O.a.createElement(Te,{tab:"\u6b4c\u8bcd\u5217\u8868",key:"lrc"},O.a.createElement(Me,null)))))},De=function(){return O.a.createElement("p",null,"\u6d4b\u8bd5\u5728\u7ebf\u97f3\u4e50\u64ad\u653e")},Ue=(a(391),function(){return O.a.createElement("section",{className:"page-home"},O.a.createElement("section",{className:"wrapper-box"},O.a.createElement("section",{className:"nav"},O.a.createElement("p",{className:"nav-item"},O.a.createElement(k.b,{to:"/",exact:!0},"\u63a8\u8350")),O.a.createElement("p",{className:"nav-item"},O.a.createElement(k.b,{to:"/local"},"\u672c\u5730\u97f3\u4e50"))),O.a.createElement("section",{className:"music-box"},O.a.createElement(x.c,null,O.a.createElement(x.a,{path:"/local",exact:!0},O.a.createElement(ze,null)),O.a.createElement(x.a,{path:"/",exact:!0},O.a.createElement(De,null))))),O.a.createElement(he,null))});a(392);var Ae=function(){return O.a.createElement("section",{className:"hzfe-music"},O.a.createElement(k.a,null,O.a.createElement(x.c,null,O.a.createElement(x.a,{path:"/",exact:!0},O.a.createElement(Ue,null)),O.a.createElement(x.a,{path:"*",exact:!0},O.a.createElement(Ue,null)))))},Re=a(27),He=a(206),Ke=a.n(He);a(393),a(394);Y.a.config({name:"HZFE-MUSIC"}),P.a.render(O.a.createElement(Re.a,{locale:Ke.a},O.a.createElement(Ae,null)),document.getElementById("root"))}},[[211,1,2]]]);
//# sourceMappingURL=main.ce0b073e.chunk.js.map