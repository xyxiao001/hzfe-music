(this["webpackJsonphzfe-music"]=this["webpackJsonphzfe-music"]||[]).push([[0],{211:function(e,t,a){e.exports=a(400)},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},219:function(e,t,a){},222:function(e,t,a){},305:function(e,t){},307:function(e,t){},315:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},400:function(e,t,a){"use strict";a.r(t);var n,r,c,i,l,s,u,o,m,f,p,d,b,h,y,g,v,E=a(0),j=a.n(E),O=a(31),x=a.n(O),w=a(98),P=a(35),N=a(7),k=a.n(N),L=a(29),M=a(38),I=(a(216),a(48)),C=function(){var e=Object(L.a)(k.a.mark((function e(t){var a,n=arguments;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(n.length>1&&void 0!==n[1])||n[1],t){e.next=3;break}return e.abrupt("return","");case 3:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var n=t.target;e(a?n.result?new Blob([n.result]):null:n.result)},r.onerror=n,a?r.readAsArrayBuffer(t):r.readAsText(t)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){for(var t,a=0,n=e.length,r="";a<n;)t=e.subarray(a,Math.min(a+32768,n)),r+=String.fromCharCode.apply(null,t),a+=32768;return btoa(r)},z=function(e){var t=Math.floor(e/60)||0,a=~~(e-60*t)||0;return(t<10?"0":"")+t+":"+(a<10?"0":"")+a},D=function(e){var t,a=(null===(t=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(e))||void 0===t?void 0:t.map((function(e){return e?Number(e):0})))||[];return 60*a[1]+a[2]+(a[4]?a[4]/(2===(a[4]+"").length?100:1e3):0)},S=(a(217),function(e){var t=Object(E.useState)([]),a=Object(M.a)(t,2),n=a[0],r=a[1],c=Object(E.useState)(-1),i=Object(M.a)(c,2),l=i[0],s=i[1],u=Object(E.useRef)(null),o=Object(E.useState)(!0),m=Object(M.a)(o,2),f=m[0],p=m[1],d=Object(E.useState)(0),b=Object(M.a)(d,2),h=b[0],y=b[1];Object(E.useEffect)((function(){r(function(e){var t=e;if(t){for(var a=(t=t.replace(/([^\]^\n])\[/g,(function(e,t){return t+"\n["}))).split("\n"),n=[],r=a.length,c=0;c<r;c++){var i=a[c].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),l=a[c].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$/g,"");if(i)for(var s=i.length,u=0;u<s;u++){var o=D(i[u]);n.push({time:o,text:l})}}return(n=n.filter((function(e){return e.text}))).sort((function(e,t){return e.time-t.time})),n}return[]}(e.lrc))}),[e.lrc]),Object(E.useEffect)((function(){s(function(e,t){if(e.length<=0)return-1;for(var a=0;a<e.length&&!(e[a].time>t);)a++;return a-1}(n,e.currentTime)),n.length&&n[l]&&e.setCurrentLrc(n[l].text)}),[l,n,e,e.currentTime]),Object(E.useEffect)((function(){if(u&&f&&e.isPlaying){var t=u.current,a=h*(l-1)||0;t&&t.scrollTo({top:a,behavior:"smooth"})}}),[f,h,l,e.isPlaying]);var g=function(e){return l===e?"choose-lrc":""},v=function(){y(7.5*document.body.offsetHeight/100)};return Object(E.useEffect)((function(){return window.addEventListener("resize",v),v(),function(){window.removeEventListener("resize",v)}}),[]),j.a.createElement("section",{className:"music-lrc",ref:u,onMouseEnter:function(){p(!1)},onMouseLeave:function(){if(e.isPlaying){var t=u.current,a=h*(l-1)||0;t&&t.scrollTo({top:a,behavior:"auto"}),p(!0)}else p(!0)}},j.a.createElement("section",{className:"lrc-list"},n.map((function(t,a){return j.a.createElement("p",{key:"".concat(t.time).concat(l).concat(t.text),style:{color:l===a?e.color:""},className:g(a)},t.text)}))))}),B=(a(218),a(219),a(405)),A=function(e){var t=Object(E.useState)(0),a=Object(M.a)(t,2),n=a[0],r=a[1],c=Object(E.useState)(!1),i=Object(M.a)(c,2),l=i[0],s=i[1];Object(E.useEffect)((function(){l||r(e.range)}),[l,e.range]);return j.a.createElement("section",{className:"progress"},j.a.createElement(B.a,{defaultValue:0,value:n,onChange:function(t){s(!0),e.setChange(!0),r(t),e.handleChanging(t)},onAfterChange:function(t){e.setChange(!1),s(!1)},tooltipVisible:!1}))},U=a(408),R=a(409),F=a(410),K=a(411),H=a(161),q=a(43),J=a(131),V=a(132),Z=a(34),$=(a(221),a(17)),G=a(196),Q=a(41),W=a.n(Q),X=function(){var e=Object(L.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-lrc-list",e.next=3,W.a.getItem("music-lrc-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return a=e.t0,a.every((function(e){return e.fileName!==t.fileName}))&&a.push(t),e.abrupt("return",W.a.setItem("music-lrc-list",a));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(L.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-lrc-list",e.next=3,W.a.getItem("music-lrc-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return t=e.t0,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(L.a)(k.a.mark((function e(t,a){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-list",e.next=3,W.a.getItem("music-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:if(n=e.t0,!n.every((function(e){return e.fileName!==t.fileName}))){e.next=14;break}return r="".concat(t.fileName,"-").concat(100*Math.random(),"-").concat(Date.now()),t.id=r,e.next=13,W.a.setItem(r,a);case 13:n.push(t);case 14:return e.abrupt("return",W.a.setItem("music-list",n));case 15:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ee=function(){var e=Object(L.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(L.a)(k.a.mark((function e(a,n){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"music-list",e.next=4,W.a.getItem("music-list");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:return r=(r=e.t0).filter((function(e){return e.id!==t})),e.next=11,W.a.setItem("music-list",r);case 11:return e.next=13,W.a.removeItem(t);case 13:a(!0),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(0),n(e.t1);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(L.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"music-list",e.next=3,W.a.getItem("music-list");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return t=e.t0,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(L.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(L.a)(k.a.mark((function e(a,n){var r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.getItem("music-list");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:if(r=e.t0,c=r.filter((function(e){return e.id===t}))[0]){e.next=11;break}n("\u83b7\u53d6\u6b4c\u66f2\u4fe1\u606f\u5931\u8d25"),e.next=20;break;case 11:return e.next=13,W.a.getItem(t);case 13:if(c.music=e.sent,!c.lrcKey){e.next=19;break}return e.next=17,Y();case 17:e.sent.forEach((function(e){e.fileName===c.lrcKey&&(c.lrc=e.content)}));case 19:a(c);case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(L.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(L.a)(k.a.mark((function e(a,n){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"music-lrc-list",e.next=4,W.a.getItem("music-lrc-list");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=[];case 7:return r=(r=e.t0).filter((function(e){return e.fileName!==t})),e.next=11,W.a.setItem("music-lrc-list",r);case 11:a(!0),e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),n(e.t1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=a(209),ce=new(n=function(){function e(){var t=this;Object(J.a)(this,e),Object(q.a)(this,"preUrl",r,this),Object(q.a)(this,"musicPlayer",c,this),this.handlePlay=function(){var e,a,n;(console.log("\u6b4c\u66f2\u64ad\u653e\u4e86"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),duration:null===(a=t.musicPlayer)||void 0===a?void 0:a.duration(),playing:!0,change:!1}),t.musicInfo&&!t.musicInfo.duration)&&(t.musicInfo.duration=Number(null===(n=t.musicPlayer)||void 0===n?void 0:n.duration()))},this.handlePause=function(){var e;console.log("\u6b4c\u66f2\u6682\u505c\u4e86"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1})},this.handleEnd=function(){var e;console.log("\u6b4c\u66f2\u64ad\u653e\u5b8c\u4e86"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1}),requestAnimationFrame(t.handlePlaying),t.handleNextMusic()},this.handleStop=function(){var e;console.log("\u6b4c\u66f2\u505c\u6b62"),t.updatedMusicData({currentTime:null===(e=t.musicPlayer)||void 0===e?void 0:e.seek(),playing:!1})},this.handlePlaying=function(){!t.musicData.change&&t.musicPlayer&&t.musicPlayer.playing()&&(t.updatedMusicData({type:"update",currentTime:t.musicPlayer.seek()}),requestAnimationFrame(t.handlePlaying))},Object(q.a)(this,"musicInfo",i,this),Object(q.a)(this,"musicData",l,this),Object(q.a)(this,"musicPlayerStats",s,this),Object(q.a)(this,"musicPlayList",u,this),Object(q.a)(this,"updateMusicPlayList",o,this),this.handleNextMusic=function(){t.musicPlayer&&t.musicPlayer.stop();for(var e=0,a=t.musicPlayList.length-1;e<t.musicPlayList.length&&t.musicPlayList[e].id!==t.musicData.id;)e++;var n,r=e+1;(r=r>a?r-a-1:r,t.musicPlayList[r].id===t.musicData.id)?null===(n=t.musicPlayer)||void 0===n||n.play():ce.updatedMusicData({id:t.musicPlayList[r].id})},this.handlePreMusic=function(){t.musicPlayer&&t.musicPlayer.stop();for(var e=0,a=t.musicPlayList.length-1;e<t.musicPlayList.length&&t.musicPlayList[e].id!==t.musicData.id;)e++;var n,r=e-1;(r=r<0?a:r,t.musicPlayList[r].id===t.musicData.id)?null===(n=t.musicPlayer)||void 0===n||n.play():ce.updatedMusicData({id:t.musicPlayList[r].id})},Object(q.a)(this,"localMusicList",m,this),Object(q.a)(this,"localMusicLoading",f,this),Object(q.a)(this,"updateLocalMusicList",p,this),Object(q.a)(this,"deleteMusic",d,this),this.localMusicLrcList=[],Object(q.a)(this,"localMusicLrcLoading",b,this),Object(q.a)(this,"updateLocalMusicLrcList",h,this),Object(q.a)(this,"deleteLrc",y,this),Object(q.a)(this,"musicColor",g,this),Object(q.a)(this,"updateMusicColor",v,this)}return Object(V.a)(e,[{key:"updatePreUrl",value:function(e){this.preUrl=e}},{key:"createdPlayer",value:function(){if(this.musicInfo){this.updatedMusicData({playing:!1}),this.preUrl&&URL.revokeObjectURL(this.preUrl);var e=URL.createObjectURL(this.musicInfo.music);this.updatePreUrl(e),this.musicPlayer=new G.Howl({autoplay:!0,src:e,html5:!0,format:[(t=this.musicInfo.codec.toLowerCase()||String(this.musicInfo.fileType).toLowerCase(),"mpeg 1 layer 3"===t?"mp3":t)],volume:1,onplay:this.handlePlay,onpause:this.handlePause,onend:this.handleEnd,onstop:this.handleStop})}var t}},{key:"destroyPlayer",value:function(){this.musicPlayer=null}},{key:"updatedMusicInfo",value:function(e){0===e.picture.length&&(e.picture=["".concat(".","/images/music-no.jpeg")]),this.musicInfo=e}},{key:"updatedMusicData",value:function(e){var t=this;"update"!==e.type?(e.hasOwnProperty("min")&&(e.min?document.body.classList.remove("dialog-screen"):document.body.classList.add("dialog-screen")),e.change||setTimeout((function(){requestAnimationFrame(t.handlePlaying)}),100),this.musicData=Object(H.a)(Object(H.a)({},this.musicData),e)):this.musicData.currentTime=e.currentTime}}]),e}(),r=Object(Z.a)(n.prototype,"preUrl",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(Z.a)(n.prototype,"updatePreUrl",[$.f],Object.getOwnPropertyDescriptor(n.prototype,"updatePreUrl"),n.prototype),c=Object(Z.a)(n.prototype,"musicPlayer",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(Z.a)(n.prototype,"createdPlayer",[$.f],Object.getOwnPropertyDescriptor(n.prototype,"createdPlayer"),n.prototype),Object(Z.a)(n.prototype,"destroyPlayer",[$.f],Object.getOwnPropertyDescriptor(n.prototype,"destroyPlayer"),n.prototype),i=Object(Z.a)(n.prototype,"musicInfo",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(Z.a)(n.prototype,"updatedMusicInfo",[$.f],Object.getOwnPropertyDescriptor(n.prototype,"updatedMusicInfo"),n.prototype),l=Object(Z.a)(n.prototype,"musicData",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{id:"",playing:!1,duration:0,currentTime:0,change:!1,min:!0}}}),Object(Z.a)(n.prototype,"updatedMusicData",[$.f],Object.getOwnPropertyDescriptor(n.prototype,"updatedMusicData"),n.prototype),s=Object(Z.a)(n.prototype,"musicPlayerStats",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{loop:"random"}}}),u=Object(Z.a)(n.prototype,"musicPlayList",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o=Object(Z.a)(n.prototype,"updateMusicPlayList",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.musicPlayList=t}}}),m=Object(Z.a)(n.prototype,"localMusicList",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=Object(Z.a)(n.prototype,"localMusicLoading",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=Object(Z.a)(n.prototype,"updateLocalMusicList",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object(L.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localMusicLoading=!0,t.next=3,te();case 3:e.localMusicList=t.sent,e.updateMusicPlayList(Object(I.cloneDeep)(e.localMusicList)),e.localMusicLoading=!1;case 6:case"end":return t.stop()}}),t)})))}}),d=Object(Z.a)(n.prototype,"deleteMusic",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(L.a)(k.a.mark((function t(a){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee(a);case 3:re.b.success("\u5220\u9664\u6210\u529f"),e.updateLocalMusicList(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),re.b.error("\u5220\u9664\u5931\u8d25");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}}),b=Object(Z.a)(n.prototype,"localMusicLrcLoading",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=Object(Z.a)(n.prototype,"updateLocalMusicLrcList",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object(L.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localMusicLrcLoading=!0,t.next=3,Y();case 3:e.localMusicLrcList=t.sent,e.localMusicLrcLoading=!1;case 5:case"end":return t.stop()}}),t)})))}}),y=Object(Z.a)(n.prototype,"deleteLrc",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(L.a)(k.a.mark((function t(a){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne(a);case 3:re.b.success("\u5220\u9664\u6210\u529f"),e.updateLocalMusicLrcList(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),re.b.error("\u5220\u9664\u5931\u8d25");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}}),g=Object(Z.a)(n.prototype,"musicColor",[$.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"#1890ff"}}),v=Object(Z.a)(n.prototype,"updateMusicColor",[$.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.musicColor=t,document.documentElement.style.setProperty("--primary-color",t)}}}),n),ie=ce,le=function(e){var t,a,n=Object(E.useState)(0),r=Object(M.a)(n,2),c=r[0],i=r[1];return Object(E.useEffect)((function(){var t,a=(null===(t=e.currentInfo)||void 0===t?void 0:t.duration)||e.musicPlayingInfo.duration||0;i(e.currentTime/a*100)}),[e.currentInfo,e.currentTime,e.musicPlayingInfo.duration]),j.a.createElement("section",{className:"player-control"},e.min?j.a.createElement("section",{className:"control-min"},j.a.createElement("section",{className:"control-icon-list"},j.a.createElement("p",{onClick:ie.handlePreMusic},j.a.createElement(U.a,null)),j.a.createElement("p",{className:"icon-play-bg",onClick:function(){e.isPlaying?e.handlePause():e.handlePlay()}},e.isPlaying?j.a.createElement(R.a,null):j.a.createElement(F.a,null)),j.a.createElement("p",{onClick:ie.handleNextMusic},j.a.createElement(K.a,null))),j.a.createElement("section",{className:"control-progress"},j.a.createElement(A,{range:Number(c.toFixed(2)),handleChanging:e.handleChanging,setChange:e.setChange})),j.a.createElement("section",{className:"line-left"},j.a.createElement("span",null," ",z(e.currentTime||0)," "),j.a.createElement("span",null,"/"),j.a.createElement("span",null," ",z((null===(t=e.currentInfo)||void 0===t?void 0:t.duration)||e.musicPlayingInfo.duration||0)," "))):j.a.createElement("section",{className:"control"},j.a.createElement("section",{className:"control-progress"},j.a.createElement(A,{range:Number(c.toFixed(2)),handleChanging:e.handleChanging,setChange:e.setChange})),j.a.createElement("section",{className:"control-line"},j.a.createElement("section",{className:"line-left"},j.a.createElement("span",null," ",z(e.currentTime||0)," "),j.a.createElement("span",null," ",z((null===(a=e.currentInfo)||void 0===a?void 0:a.duration)||e.musicPlayingInfo.duration||0)," ")),j.a.createElement("section",{className:"line-center"},j.a.createElement("section",{className:"control-icon-list"},j.a.createElement("p",{onClick:ie.handlePreMusic},j.a.createElement(U.a,null)),j.a.createElement("p",{className:"icon-play-bg",onClick:function(){e.isPlaying?e.handlePause():e.handlePlay()}},e.isPlaying?j.a.createElement(R.a,null):j.a.createElement(F.a,null)),j.a.createElement("p",{onClick:ie.handleNextMusic},j.a.createElement(K.a,null)))))))},se=(a(222),function(e){var t=Object(E.useState)([]),a=Object(M.a)(t,2),n=a[0],r=a[1],c=Object(E.useState)(-1),i=Object(M.a)(c,2),l=i[0],s=i[1],u=Object(E.useRef)(null),o=Object(E.useState)(!0),m=Object(M.a)(o,2),f=m[0],p=m[1],d=Object(E.useState)({backgroundImage:""}),b=Object(M.a)(d,2),h=b[0],y=b[1],g=Object(E.useState)(0),v=Object(M.a)(g,2),O=v[0],x=v[1];Object(E.useEffect)((function(){r(function(e){var t=[];console.log("\u8fdb\u5165\u9010\u5b57\u89e3\u6790\u7684\u6b4c\u8bcd\u54e6");for(var a=e.split("\n"),n=0;n<a.length;){var r=a[n].replace(/\s/g,""),c=r.match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),i=r.match(/(?<=\])\S\s?(?=\[)/g);if(c&&i){for(var l=[],s=0;s<i.length;s++)l.push({text:i[s],start:D(c[s]),end:D(c[s+1])});t.push(l)}n++}return t}(e.lrc))}),[e.lrc]),Object(E.useEffect)((function(){if(s(function(e,t){if(e.length<=0)return-1;for(var a=0;a<e.length&&!(e[a][0].start>t);)a++;return a-1}(n,e.currentTime)),n[l]&&n[l].length){var t=n[l].map((function(e){return e.text}));e.setCurrentLrc(t.join(""))}var a=function(e,t){if(!e)return 0;for(var a=0,n=0;n<e.length&&!(e[n].start>t);)n++;if(n<=0)return 0;if(n>=e.length)return 100;a=n*(100/e.length);var r=e[n-1];if(t>=r.end)return 100;if(t<=r.start)return(n-1)*(100/e.length);var c=r.end-r.start;return a+=(t-r.start)/c*(100/e.length)}(n[l],e.currentTime);y({backgroundImage:"-webkit-linear-gradient(left,".concat(e.color," ").concat(a,"%,#ffffff ").concat(a,"%)")})}),[l,n,e,e.currentTime]),Object(E.useEffect)((function(){if(u&&f&&e.isPlaying){var t=u.current,a=O*(l-1)||0;t&&t.scrollTo({top:a,behavior:"smooth"})}}),[f,O,l,e.isPlaying]);var w=function(e){return l===e?"choose-lrc-line":""},P=function(){x(7.5*document.body.offsetHeight/100)};return Object(E.useEffect)((function(){return window.addEventListener("resize",P),P(),function(){window.removeEventListener("resize",P)}}),[]),j.a.createElement("section",{className:"music-lrc-word",ref:u,onMouseEnter:function(){p(!1)},onMouseLeave:function(){if(p(!0),e.isPlaying){var t=u.current,a=O*(l-1)||0;t&&t.scrollTo({top:a,behavior:"auto"})}}},j.a.createElement("section",{className:"lrc-list"},n.map((function(e,t){return j.a.createElement("section",{key:t,className:"lrc-line"},j.a.createElement("p",{className:w(t),style:l===t?h:{}},e.map((function(e,t){return j.a.createElement("span",{key:t},e.text)}))))}))))}),ue=a(198),oe=a(160),me=a(141),fe=a(99),pe=new ue.a,de=Object(fe.a)((function(){var e,t=ie.musicPlayer,a=ie.musicInfo,n=ie.musicData,r=Object(E.useState)(""),c=Object(M.a)(r,2),i=c[0],l=c[1],s=Object(E.useRef)(!1),u=ie.musicColor,o=function(e){var t=((null===a||void 0===a?void 0:a.duration)||0)*e/100;ie.updatedMusicData({currentTime:t})},m=function(e){e||(null===t||void 0===t||t.seek(n.currentTime),n.playing||null===t||void 0===t||t.play()),ie.updatedMusicData({change:e})},f=Object(E.useCallback)(Object(L.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(L.a)(k.a.mark((function e(t,a){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(n.id);case 2:(r=e.sent)?t(r):a("\u6b4c\u66f2\u4fe1\u606f\u83b7\u53d6\u5931\u8d25");case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),[n.id]),p=Object(E.useCallback)((function(){t&&(t.playing()?t.pause():t.play())}),[t]),d=Object(E.useCallback)(Object(L.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,f();case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return");case 7:ie.updatedMusicInfo(t),pe.getColorAsync(t.picture[0]).then((function(e){ie.updateMusicColor(Object(oe.b)(.8,Object(oe.a)(.5,e.rgba)))})).catch((function(e){ie.updateMusicColor("#1890ff")}));case 9:case"end":return e.stop()}}),e)}))),[f,n.id]),b=Object(E.useCallback)((function(e){e.preventDefault(),32===e.keyCode&&p()}),[p]),h=function(){ie.updatedMusicData({min:!n.min})};return Object(E.useEffect)((function(){console.log("useEffect-getMusicInfo"),d()}),[d]),Object(E.useEffect)((function(){return console.log("useEffect-create"),a&&!t&&(l(""),console.log("\u521b\u5efa\u97f3\u4e50\u5b9e\u4f8b"),ie.createdPlayer()),function(){t&&(console.log("created destroy"),ie.updatedMusicData({playing:!1}),ie.destroyPlayer())}}),[a,t]),Object(E.useEffect)((function(){console.log("music-change-key"),s.current=n.change}),[n.change]),Object(E.useEffect)((function(){return window.addEventListener("keydown",b),function(){window.removeEventListener("keydown",b)}}),[b]),j.a.createElement("section",{className:"player"},n.min?j.a.createElement("section",{className:"player-min"},a?j.a.createElement("section",{className:"player-layout"},j.a.createElement("section",{className:"layout-left"},j.a.createElement("section",{className:"music-img",onClick:h},j.a.createElement("img",{src:a.picture.length>0?a.picture[0]:"./images/music-no.jpeg",alt:""})),j.a.createElement("section",{className:"player-info"},j.a.createElement("p",{className:"music-name"},a.name),j.a.createElement("p",{className:"music-artist"},a.artist," - ",a.album))),j.a.createElement("section",{className:"music-progress"},j.a.createElement(le,{handlePlay:p,handlePause:p,currentInfo:a||null,musicPlayingInfo:n,currentTime:n.currentTime,handleChanging:o,setChange:m,min:n.min,isPlaying:n.playing}))):j.a.createElement("section",{className:"player-layout"},"\u8bf7\u9009\u62e9\u6b4c\u66f2\u8fdb\u884c\u64ad\u653e")):j.a.createElement("section",{className:"player-max"},j.a.createElement("section",{className:"status-control",onClick:h},j.a.createElement(me.a,null)),j.a.createElement("section",{className:"player-bg",style:{backgroundImage:"url(".concat((null===a||void 0===a?void 0:a.picture[0])||"./images/music-no.jpeg",")")}}),j.a.createElement("section",{className:"player-fade"}),j.a.createElement("section",{className:"player-layout"},a?j.a.createElement("section",{className:"player-box"},j.a.createElement("section",{className:"player-left"},j.a.createElement("section",{className:"player-line"},j.a.createElement("img",{src:a.picture.length>0?a.picture[0]:"./images/music-no.jpeg",alt:""})),j.a.createElement("section",{className:"player-line"},j.a.createElement("section",{className:"player-info"},j.a.createElement("p",{className:"music-name"},a.name),j.a.createElement("p",{className:"music-artist"},a.artist," - ",a.album),j.a.createElement("p",{className:"music-current-lrc"},i))),j.a.createElement(le,{handlePlay:p,handlePause:p,currentInfo:a||null,musicPlayingInfo:n,currentTime:n.currentTime,handleChanging:o,setChange:m,isPlaying:n.playing})),j.a.createElement("section",{className:"player-right"},(null===(e=a.lrc)||void 0===e?void 0:e.match(/\](\S)\[/g))?j.a.createElement(se,{setCurrentLrc:l,color:u,lrc:a.lrc||"",currentInfo:a||null,currentTime:n.currentTime,isPlaying:n.playing}):j.a.createElement(S,{setCurrentLrc:l,color:u,lrc:a.lrc||"",currentInfo:a||null,currentTime:n.currentTime,isPlaying:n.playing}))):"")))})),be=a(199),he=a(403),ye=a(52),ge=a(412),ve=(a(315),["mp3","ogg","wav","aac","flac","dolby","opus","webm","alac"]),Ee=["lrc","txt"],je=a(156),Oe=a.n(je),xe=function(){var e=function(){var e=Object(L.a)(k.a.mark((function e(t){var a,n,r,c,i,l;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name.split("."),n=a[a.length-1],r=t.name.replace(".".concat(n),""),e.prev=3,e.next=6,C(t,!0);case 6:return c=e.sent,e.next=9,be.parseBlob(c);case 9:i=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(3),re.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(n,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(r)),e.abrupt("return");case 16:s=i,(l={name:Object(I.get)(s,"common.title",""),album:Object(I.get)(s,"common.album",""),albumartist:Object(I.get)(s,"common.albumartist",""),artist:Object(I.get)(s,"common.artist",""),artists:Object(I.get)(s,"common.artists",[]),comment:Object(I.get)(s,"common.comment",[]),date:Object(I.get)(s,"common.date",0),picture:Object(I.get)(s,"common.picture",[]).map((function(e){return"data:".concat(e.format,";base64,").concat(T(e.data))})),codec:Object(I.get)(s,"format.codec",""),duration:Object(I.get)(s,"format.duration",0),sampleRate:Object(I.get)(s,"format.sampleRate",""),lrc:""}).fileName=r,l.fileType=n,l.fileSize=Oe()(t.size),l.size=t.size,l.name=l.name||l.fileName||"\u672a\u77e5\u6b4c\u66f2",_(l,c).then((function(e){console.log(e),re.b.success("".concat(t.name,"  \u4e0a\u4f20\u6210\u529f")),ie.updateLocalMusicList()}));case 23:case"end":return e.stop()}var s}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(L.a)(k.a.mark((function e(t){var a,n,r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name.split("."),n=a[a.length-1],r=t.name.replace(".".concat(n),""),c="",e.prev=4,e.next=7,C(t,!1);case 7:c=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),re.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(n,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(r)),e.abrupt("return");case 14:X({content:c,fileName:r,fileType:n,size:t.size,fileSize:Oe()(t.size)}).then((function(e){ie.updateLocalMusicLrcList(),re.b.success("".concat(t.name,"  \u4e0a\u4f20\u6210\u529f"))}));case 15:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}();return j.a.createElement("section",{className:"page-upload"},j.a.createElement("section",{className:"upload-line"},j.a.createElement(he.a,{beforeUpload:function(a){var n=a.name.split("."),r=n[n.length-1],c=a.name.replace(".".concat(r),"");return ve.includes(r)?(console.log("\u5f53\u524d\u662f\u97f3\u9891\u6587\u4ef6\u5904\u7406",c,r),e(a),!1):Ee.includes(r)?(console.log("\u5f53\u524d\u662f\u6b4c\u8bcd\u6587\u4ef6\u5904\u7406",c,r),t(a),!1):(re.b.warning("\u76ee\u524d\u8fd8\u4e0d\u652f\u6301\u5904\u7406".concat(r,"\u8fd9\u79cd\u7c7b\u578b\u6587\u4ef6\uff0c").concat(c)),!1)},showUploadList:!1,accept:function(){var e=ve.concat(Ee);return(e=e.map((function(e){return e=".".concat(e)}))).join(",")}(),multiple:!0},j.a.createElement(ye.a,{icon:j.a.createElement(ge.a,null)},"\u70b9\u51fb\u4e0a\u4f20\u672c\u5730\u6b4c\u66f2\u6216\u8005\u6b4c\u8bcd")),j.a.createElement("p",{className:"tips"},j.a.createElement("span",null,"\u652f\u6301\u6b4c\u66f2\u683c\u5f0f ",ve.join("\uff0c")),j.a.createElement("span",null,"\u652f\u6301\u6b4c\u8bcd\u683c\u5f0f ",Ee.join("\uff0c")))))},we=a(404),Pe=a(406),Ne=a(402),ke=Object(fe.a)((function(){var e=[{title:"\u6b4c\u8bcd\u540d",dataIndex:"fileName",key:"fileName"},{title:"\u5927\u5c0f",dataIndex:"fileSize",key:"fileSize",sorter:function(e,t){return e.size-t.size}},{title:"\u64cd\u4f5c",dataIndex:"name",key:"control",render:function(e,t){return j.a.createElement("p",null,j.a.createElement(Pe.a,{placement:"topRight",title:"\u786e\u5b9a\u5220\u9664-".concat(t.fileName,"-\u6b4c\u8bcd\u561b"),onConfirm:function(){return n(t.fileName||"")},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},j.a.createElement("span",{className:"link"},"\u5220\u9664")))}}],t=ie.localMusicLrcList,a=ie.localMusicLrcLoading,n=function(e){ie.deleteLrc(e)};return Object(E.useEffect)((function(){console.log("\u83b7\u53d6\u6b4c\u8bcd\u5217\u8868"),ie.updateLocalMusicLrcList()}),[]),j.a.createElement("section",{className:"lrc-list"},j.a.createElement(Ne.a,{dataSource:t,columns:e,pagination:!1,rowKey:"fileName",loading:a}))})),Le=a(407),Me=(a(386),a(387),function(){return j.a.createElement("p",{className:"playing-icon"},j.a.createElement("span",{className:"rect1"}),j.a.createElement("span",{className:"rect2"}),j.a.createElement("span",{className:"rect3"}),j.a.createElement("span",{className:"rect4"}),j.a.createElement("span",{className:"rect5"}))}),Ie=Object(fe.a)((function(){var e=ie.musicData,t=ie.localMusicList,a=ie.localMusicLoading,n=[{title:"\u6b4c\u66f2",dataIndex:"name",key:"name",width:300,render:function(t,a){return j.a.createElement("section",{className:"list-play"},(null===e||void 0===e?void 0:e.id)===a.id&&e.playing?j.a.createElement("span",null,j.a.createElement(R.a,{className:"icon",onClick:function(){return c()}})):j.a.createElement("span",null,j.a.createElement(F.a,{className:"icon",onClick:function(){return r(a)}})),j.a.createElement("span",null,t),(null===e||void 0===e?void 0:e.id)===a.id&&e.playing?j.a.createElement(Me,null):"")}},{title:"\u6b4c\u624b",dataIndex:"artist",key:"artist"},{title:"\u4e13\u8f91",dataIndex:"album",key:"album"},{title:"\u65f6\u957f",dataIndex:"duration",key:"duration",render:function(e){return z(e)||"\u672a\u77e5"},sorter:function(e,t){return Number(e.duration)-Number(t.duration)}},{title:"\u683c\u5f0f",dataIndex:"codec",key:"codec",render:function(e,t){return e||t.fileType}},{title:"\u5927\u5c0f",dataIndex:"fileSize",key:"fileSize",sorter:function(e,t){return Number(e.size)-Number(t.size)}},{title:"\u5173\u8054\u6b4c\u8bcd\u540d",dataIndex:"lrcKey",key:"lrcKey",render:function(e,t){return e||j.a.createElement(Le.b,{size:"middle"},j.a.createElement("span",{className:"action"},"\u5173\u8054\u6b4c\u8bcd"))}},{title:"\u64cd\u4f5c",dataIndex:"name",key:"control",render:function(e,t){return j.a.createElement("p",null,j.a.createElement(Pe.a,{placement:"topRight",title:"\u786e\u5b9a\u5220\u9664-".concat(t.name,"-\u8fd9\u9996\u6b4c\u561b"),onConfirm:function(){return i(t.id||"")},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},j.a.createElement("span",{className:"link"},"\u5220\u9664")))}}],r=function(t){var a;t.id!==e.id?(null===(a=ie.musicPlayer)||void 0===a||a.stop(),setTimeout((function(){ie.updatedMusicData({id:t.id})}),100)):ie.musicPlayer&&ie.musicPlayer.play()},c=function(){var e;null===(e=ie.musicPlayer)||void 0===e||e.pause()},i=function(e){ie.deleteMusic(e)};return Object(E.useEffect)((function(){console.log("\u83b7\u53d6\u97f3\u4e50\u5217\u8868"),ie.updateLocalMusicList()}),[]),j.a.createElement("section",{className:"lrc-list"},j.a.createElement(Ne.a,{dataSource:t,columns:n,pagination:!1,rowKey:"fileName",loading:a}))})),Ce=we.a.TabPane,Te=function(){var e=Object(P.f)(),t=new URLSearchParams(Object(P.g)().search),a=Object(P.g)(),n=Object(E.useState)(""),r=Object(M.a)(n,2),c=r[0],i=r[1],l=function(){var e=Object(L.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(L.a)(k.a.mark((function e(t,a){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te();case 3:return n=e.sent,e.next=6,Y();case 6:return r=e.sent,n=n.map((function(e){return r.forEach((function(t){t.fileName.includes(e.name)&&(e.lrcKey=t.fileName)})),e})),e.next=10,W.a.setItem("music-list",n);case 10:t("success"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),a(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,a){return e.apply(this,arguments)}}());case 2:re.b.success("\u5173\u8054\u6210\u529f"),ie.updateLocalMusicList(),ie.updateLocalMusicLrcList();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(E.useEffect)((function(){if(t){var e=t.get("type")||"";["music","lrc"].includes(e)?i(e):i("music")}}),[t]),j.a.createElement("section",{className:"page-local"},j.a.createElement("section",{className:"local-upload"},j.a.createElement(xe,null),j.a.createElement("section",null,j.a.createElement(ye.a,{onClick:l},"\u81ea\u52a8\u5173\u8054\u6b4c\u8bcd"),j.a.createElement("p",{className:"tips"},"\u5173\u8054\u89c4\u5219: \u5f53\u524d\u6b4c\u66f2\u6ca1\u6709\u6b4c\u8bcd\uff0c\u540c\u65f6\u53ef\u4ee5\u627e\u5230\u6b4c\u8bcd\u540d\uff0c\u5305\u542b\u5b8c\u6574\u6b4c\u66f2\u540d"))),j.a.createElement("section",{className:"local-content"},j.a.createElement(we.a,{activeKey:c,onChange:function(t){e.push("".concat(a.pathname,"?type=").concat(t))}},j.a.createElement(Ce,{tab:"\u97f3\u4e50\u5217\u8868",key:"music"},j.a.createElement(Ie,null)),j.a.createElement(Ce,{tab:"\u6b4c\u8bcd\u5217\u8868",key:"lrc"},j.a.createElement(ke,null)))))};console.log({music:"http://172.28.150.185:8887/%E5%85%AB%E5%BA%A6%E7%A9%BA%E9%97%B4/08.%E5%9B%9E%E5%88%B0%E8%BF%87%E5%8E%BB.flac",lrc:"http://172.28.150.185:8887/%E5%85%AB%E5%BA%A6%E7%A9%BA%E9%97%B4/%E5%91%A8%E6%9D%B0%E4%BC%A6%20-%20%E5%9B%9E%E5%88%B0%E8%BF%87%E5%8E%BB.lrc"});var ze=function(){return j.a.createElement("p",null,"Love")},De=(a(391),function(){return j.a.createElement("section",{className:"page-home"},j.a.createElement("section",{className:"wrapper-box"},j.a.createElement("section",{className:"nav"},j.a.createElement("p",{className:"nav-item"},j.a.createElement(w.b,{to:"/",exact:!0},"\u63a8\u8350")),j.a.createElement("p",{className:"nav-item"},j.a.createElement(w.b,{to:"/local"},"\u672c\u5730\u97f3\u4e50"))),j.a.createElement("section",{className:"music-box"},j.a.createElement(P.c,null,j.a.createElement(P.a,{path:"/local",exact:!0},j.a.createElement(Te,null)),j.a.createElement(P.a,{path:"/",exact:!0},j.a.createElement(ze,null))))),j.a.createElement(de,null))});a(392);var Se=function(){return j.a.createElement("section",{className:"hzfe-music"},j.a.createElement(w.a,null,j.a.createElement(P.c,null,j.a.createElement(P.a,{path:"/",exact:!0},j.a.createElement(De,null)),j.a.createElement(P.a,{path:"*",exact:!0},j.a.createElement(De,null)))))},Be=a(27),Ae=a(206),Ue=a.n(Ae);a(393),a(394);W.a.config({name:"HZFE-MUSIC"}),x.a.render(j.a.createElement(Be.a,{locale:Ue.a},j.a.createElement(Se,null)),document.getElementById("root"))}},[[211,1,2]]]);
//# sourceMappingURL=main.86cde31e.chunk.js.map